<div class="mainsection">
  <form *ngIf="!isLoading; else spinner" [formGroup]="deps.draftSntForm">
    <div class="list-and-sections">
      <div class="list-sections">
        <ul>
          <li (click)="currentSection = 'A'"
              [class.active]="currentSection === 'A'">
            <span>Раздел А. Общий раздел</span>

            <span class="errors-counter" *ngIf="getSectionErrorCount('A')>0">{{getSectionErrorCount('A')}}</span>
          </li>
          <li (click)="currentSection = 'B'"
              [class.active]="currentSection === 'B'">
            <span>Раздел В. Реквизиты поставщика</span>
            <span class="errors-counter" *ngIf="getSectionErrorCount('B')">{{getSectionErrorCount('B')}}</span>
          </li>
          <li (click)="currentSection = 'C'"
              [class.active]="currentSection === 'C'">
            <span>Раздел C. Реквизиты получателя</span>
            <span class="errors-counter" *ngIf="getSectionErrorCount('C') > 0">{{getSectionErrorCount('C')}}</span>
          </li>
          <li (click)="currentSection = 'D'"
              [class.active]="currentSection === 'D'">
            <span>Раздел D. Реквизиты грузоотправителя и грузополучателя</span>
            <span class="errors-counter" *ngIf="getSectionErrorCount('D') > 0">
              {{getSectionErrorCount('D')}}
            </span>
          </li>
          <li (click)="currentSection = 'E'"
              [class.active]="currentSection === 'E'">
            <span>Раздел Е. Сведения по перевозке</span>
            <span class="errors-counter" *ngIf="getSectionErrorCount('E') > 0">{{getSectionErrorCount('E')}}</span>
          </li>
          <li (click)="currentSection = 'F'"
              [class.active]="currentSection === 'F'">
            <span> Раздел F. Договор (контракт) </span>
            <span class="errors-counter" *ngIf="getSectionErrorCount('F') > 0">
              {{getSectionErrorCount('F')}}
            </span>
          </li>
          <li (click)="currentSection = 'G'"
              [class.active]="currentSection === 'G'">
            <span> Раздел G. Данные по товарам </span>
            <span class="errors-counter" *ngIf="getSectionErrorCount('G') > 0">
              {{getSectionErrorCount('G')}}
            </span>
          </li>
          <li (click)="currentSection = 'G6'" *ngIf="deps.draftSntForm.get('hasOilProducts').value"
              [class.active]="currentSection === 'G6'">
            <span> Раздел G6. Данные по нефтепродуктам </span>
            <span class="errors-counter" *ngIf="getSectionErrorCount('G6') > 0">
              {{getSectionErrorCount('G6')}}
            </span>
          </li>
          <li (click)="currentSection = 'G10'" *ngIf="deps.draftSntForm.get('hasExportControlProducts').value"
            [class.active]="currentSection === 'G10'">
            <span> Раздел G10. Данные по товарам, подлежащие экспортному контролю </span>
            <span class="errors-counter" *ngIf="getSectionErrorCount('G10') > 0">
              {{getSectionErrorCount('G10')}}
            </span>
          </li>
        </ul>
      </div>

      <div class="sections">
        <div class="section" id="asection" *ngIf="currentSection === 'A'">
          <app-snt-section-a
            [warehouses]="warehouses"
            [draftSntForm]="deps.draftSntForm"            
            [dateFn]="DateFilter"
          ></app-snt-section-a>
        </div>
        <div class="section" id="bsection" *ngIf="currentSection === 'B'">
          <app-snt-section-b
            [draftSntForm]="deps.draftSntForm"
            [warehouses]="warehouses"
            [countries]="countries"
            [favouriteCountries]="favouriteCountries"
          ></app-snt-section-b>
        </div>
        <app-snt-section-c
          class="section"
          id="csection"
          *ngIf="currentSection === 'C'"
          [draftSntForm]="deps.draftSntForm"
          [warehouses]="warehouses"
          [countries]="countries"
          [favouriteCountries]="favouriteCountries"
        ></app-snt-section-c>
        <app-snt-section-d
          class="section"
          id="dsection"
          *ngIf="currentSection === 'D'"
          [draftSntForm]="deps.draftSntForm"
          [countries]="countries"
          [favouriteCountries]="favouriteCountries"
        ></app-snt-section-d>
        <app-snt-section-e
          class="section"
          id="esection"
          *ngIf="currentSection === 'E'"
          [draftSntForm]="deps.draftSntForm"
        ></app-snt-section-e>
        <app-snt-section-f
          class="section"
          id="fsection"
          *ngIf="currentSection === 'F'"
          [draftSntForm]="deps.draftSntForm"
        ></app-snt-section-f>
      </div>
    </div>

    <div class="full-section">
      <app-snt-section-currency
        [sntForm]="deps.draftSntForm"
        [currencies]="currencies"
        [favouriteCurrencies]="favouriteCurrencies"
      ></app-snt-section-currency>
      <app-snt-section-g
        class="section"
        id="gsection"        
        [draftSntForm]="deps.draftSntForm"
        [warehouses]="warehouses"
        [measureUnits]="measureUnits"
        [favouriteMeasureUnits]="favouriteMeasureUnits"
      ></app-snt-section-g>
        <app-snt-section-g6 class="section"
                          id="g6section"
                          [draftSntForm]="deps.draftSntForm"
                          [warehouses]="warehouses"
                          [measureUnits]="measureUnits"
                          [favouriteMeasureUnits]="favouriteMeasureUnits">
        </app-snt-section-g6>
        <app-snt-section-g10 class="section"
                          id="g10section"
                          [draftSntForm]="deps.draftSntForm"
                          [warehouses]="warehouses"
                          [measureUnits]="measureUnits"
                          [favouriteMeasureUnits]="favouriteMeasureUnits">
        </app-snt-section-g10>
    </div>
    <div *ngIf="isActionButtonsAvailable" class="create-form-buttons">
      <button
        *ngIf="hasAccess(sntAccessControlList.get('save_draft'))"
        class="create-form-buttons-color"
        mat-raised-button
        [disabled]="!this.isFormValid() || deps.draftSntForm.disabled"
        type="submit"
        (click)="saveDraft()"
      >
        Сохранить как черновик
      </button>
      <button
        *ngIf="hasAccess(sntAccessControlList.get('send'))"
        class="create-form-buttons-color"
        mat-raised-button
        type="submit"
        [disabled]="!this.isFormValid() || deps.draftSntForm.disabled"
        (click)="send()"
      >
        Отправить
      </button>
      <button class="create-form-buttons-color" mat-raised-button type="submit" (click)="close()">
        Закрыть
      </button>
    </div>
  </form>
</div>
<ng-template #spinner>
  <div style="margin-top: 20%">
    <app-loading [widthPx]="100"></app-loading>
  </div>
</ng-template>
