<div fxLayout="column">
  <app-ar-drafts-filter (filterOutput)="onFilterOutputChange($event)" fxFlexOffset="10px"></app-ar-drafts-filter>
  
  <div fxLayout="row" fxLayoutAlign="start center" fxFlexOffset="10px">
    <button *ngIf="selection.selected.length > 0" class="primary-color" mat-raised-button (click)="sign()">
      Подписать
    </button>
  </div>

  <div fxLayout="row" style="background-color: white;">
    <app-last-sync-dates fxLayoutAlign="left center"></app-last-sync-dates>
    <mat-paginator [length]="resultsLength" [pageSize]="15" [pageSizeOptions]="pageSizeOptions"
      [showFirstLastButtons]="true" fxFlex="auto"></mat-paginator>
  </div>

  <table mat-table [dataSource]="dataSource" multiTemplateDataRows class="mat-elevation-z8">
    <ng-container matColumnDef="select">
      <th mat-header-cell *matHeaderCellDef>
        <mat-checkbox (change)="$event ? masterToggle() : null" [checked]="selection.hasValue() && isAllSelected()"
          [indeterminate]="selection.hasValue() && !isAllSelected()">
        </mat-checkbox>
      </th>
      <td mat-cell *matCellDef="let element">
        <mat-checkbox (click)="$event.stopPropagation()" (change)="$event ? toggleSelection(element) : null"
          [checked]="selection.isSelected(element)">
        </mat-checkbox>
      </td>
    </ng-container>

    <ng-container matColumnDef="invoiceType">
      <th scope="col" mat-header-cell *matHeaderCellDef>Inv Type</th>
      <td mat-cell *matCellDef="let element">{{element.invoiceType}}</td>
    </ng-container>

    <ng-container matColumnDef="invoiceDate">
      <th scope="col" mat-header-cell *matHeaderCellDef>Inv Date</th>
      <td mat-cell *matCellDef="let element">{{element.invoiceDate | date: 'dd/MM/yyyy'}}</td>
    </ng-container>

    <ng-container matColumnDef="invoiceTurnoverDate">
      <th scope="col" mat-header-cell *matHeaderCellDef>Inv Turnover Date</th>
      <td mat-cell *matCellDef="let element">{{element.invoiceTurnoverDate | date: 'dd/MM/yyyy'}}</td>
    </ng-container>

    <ng-container matColumnDef="invoiceNumber">
      <th scope="col" mat-header-cell *matHeaderCellDef>Invoice Number</th>
      <td mat-cell *matCellDef="let element"><a
          [routerLink]="['/einvoicing/edit', element.invoiceNumber,element.invoiceType,element.jdeInvoiceId]"
          [queryParams]="{'isSavedForSign': true}">
          {{element.invoiceNumber}}</a></td>
    </ng-container>

    <ng-container matColumnDef="customerIinBin">
      <th scope="col" mat-header-cell *matHeaderCellDef>Customer IIN/BIN</th>
      <td mat-cell *matCellDef="let element">{{element.customerIinBin}}</td>
    </ng-container>

    <ng-container matColumnDef="customerName">
      <th scope="col" mat-header-cell *matHeaderCellDef>Customer Name</th>
      <td mat-cell *matCellDef="let element">{{element.customerName}}</td>
    </ng-container>

    <ng-container matColumnDef="contractNumber">
      <th scope="col" mat-header-cell *matHeaderCellDef>Contract #</th>
      <td mat-cell *matCellDef="let element">{{element.contractNumber}}</td>
    </ng-container>

    <ng-container matColumnDef="contractDate">
      <th scope="col" mat-header-cell *matHeaderCellDef>Contract Date</th>
      <td mat-cell *matCellDef="let element">{{element.contractDate | date: 'dd/MM/yyyy'}}</td>
    </ng-container>

    <ng-container matColumnDef="currency">
      <th scope="col" mat-header-cell *matHeaderCellDef>Currency</th>
      <td mat-cell *matCellDef="let element">{{element.currency}}</td>
    </ng-container>

    <ng-container matColumnDef="taxableAmount">
      <th scope="col" mat-header-cell *matHeaderCellDef>Values of Taxable</th>
      <td mat-cell *matCellDef="let element">{{element.taxableAmount}}</td>
    </ng-container>

    <ng-container matColumnDef="taxAmount">
      <th scope="col" mat-header-cell *matHeaderCellDef>Tax Amounts</th>
      <td mat-cell *matCellDef="let element">{{element.taxAmount}}</td>
    </ng-container>

    <ng-container matColumnDef="grossAmount">
      <th scope="col" mat-header-cell *matHeaderCellDef>Inv Amount</th>
      <td mat-cell *matCellDef="let element">{{element.grossAmount}}</td>
    </ng-container>

    <tr mat-header-row *matHeaderRowDef="columnsToDisplay; sticky: true"></tr>
    <tr mat-row *matRowDef="let row; columns: columnsToDisplay" [hidden]="dataSource.loading | async"></tr>

    <tr class="mat-row" *matNoDataRow>
      <td class="mat-cell" colspan="13">
        Нет совпадений по заданному фильтру.
      </td>
    </tr>
  </table>
  <app-loading *ngIf="dataSource.loading | async" [textLoading]="false" [widthPx]="100"></app-loading>
</div>