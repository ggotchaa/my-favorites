<div class="alert alert-info" role="alert">
  <p>Displays user account details and claims information.</p>
</div>

<div class="tabbed" role="tablist">
  <ul class="tabs">
    <li
      role="tab"
      [attr.aria-selected]="activeTab === 'get-account'"
      [class.aria-selected]="activeTab === 'get-account'"
      data-tab="get-account"
      (click)="switchTab('get-account')"
      style="cursor: pointer"
    >
      Get Account
    </li>
    <li
      role="tab"
      [attr.aria-selected]="activeTab === 'claims-principal-sync'"
      [class.aria-selected]="activeTab === 'claims-principal-sync'"
      data-tab="claims-principal-sync"
      (click)="switchTab('claims-principal-sync')"
      style="cursor: pointer"
    >
      Claims Principal (Sync)
    </li>
    <li
      role="tab"
      [attr.aria-selected]="activeTab === 'claims-principal-async'"
      [class.aria-selected]="activeTab === 'claims-principal-async'"
      data-tab="claims-principal-async"
      (click)="switchTab('claims-principal-async')"
      style="cursor: pointer"
    >
      Claims Principal (Async)
    </li>
  </ul>

  <div
    class="tab-content"
    role="tabpanel"
    [attr.aria-hidden]="activeTab !== 'get-account'"
    [style.display]="activeTab === 'get-account' ? 'block' : 'none'"
    data-content="get-account"
  >
    <div class="result">
      <button class="button small" (click)="tryGetAccount()" [disabled]="loading">
        Try getAccount()
      </button>
      <p><strong>‚öôÔ∏èMethod: </strong><code>getAccount()</code></p>
      <p><strong>üîÅReturn: </strong><code>IAccount or null</code></p>
      <p><strong>üéØResult: </strong></p>
      @if (loading) {
      <p><strong>‚è≥Loading...</strong></p>
      } @else if (account) {
      <code><p>IAccount:</p></code>
      <pre><code>{{ account | json }}</code></pre>
      } @else {
      <p><code>null</code></p>
      }
    </div>
    <div class="result">
      <strong>Related CDAS wiki: </strong>

      <ul class="arrows-after">
        <li>
          <a
            [href]="externalLinks['getAccount'].url"
            target="_blank"
            rel="noopener noreferrer"
            >{{ externalLinks["getAccount"].text }}</a
          >
        </li>
      </ul>
    </div>
  </div>

  <div
    class="tab-content"
    role="tabpanel"
    [attr.aria-hidden]="activeTab !== 'claims-principal-sync'"
    [style.display]="activeTab === 'claims-principal-sync' ? 'block' : 'none'"
    data-content="claims-principal-sync"
  >
    <div class="result">
      <button
        class="button small"
        (click)="fetchClaimsSync()"
        [disabled]="loadingSync"
      >
        Try cvxClaimsPrincipal
      </button>
      <p><strong>‚öôÔ∏èMethod: </strong><code>cvxClaimsPrincipal</code></p>
      <p><strong>üîÅReturn: </strong><code>ICvxClaimsPrincipal or null</code></p>
      <p><strong>üéØResult: </strong></p>
      @if (loadingSync) {
      <p><strong>‚è≥Loading...</strong></p>
      } @else if (claimsPrincipalSync) {
      <div class="user-details">
        <p><strong>Object ID:</strong> {{ claimsPrincipalSync.objectId }}</p>
        <p><strong>Email:</strong> {{ claimsPrincipalSync.email }}</p>
        <p><strong>User Name:</strong> {{ claimsPrincipalSync.userName }}</p>
        <p><strong>Name:</strong> {{ claimsPrincipalSync.name }}</p>
        <p><strong>Audience:</strong> {{ claimsPrincipalSync.audience }}</p>
        <p><strong>Roles:</strong> {{ claimsPrincipalSync.roles }}</p>
        <p><strong>Tenant ID:</strong> {{ claimsPrincipalSync.tenantId }}</p>
        <p>
          <strong>Token Version:</strong> {{ claimsPrincipalSync.tokenVersion }}
        </p>
        <p><strong>Issuer:</strong> {{ claimsPrincipalSync.issuer }}</p>
        <p>
          <strong>Provisioning ID:</strong>
          {{ claimsPrincipalSync.provisioningId }}
        </p>
        <p><strong>Log On Name:</strong> {{ claimsPrincipalSync.logOnName }}</p>
        <p><strong>User Type:</strong> {{ claimsPrincipalSync.userType }}</p>
        <p>
          <strong>Person Relationship Type:</strong>
          {{ claimsPrincipalSync.personRelationshipType }}
        </p>
        <p><strong>Is User:</strong> {{ claimsPrincipalSync.isUser }}</p>
        <p>
          <strong>MSAL Account ID:</strong>
          {{ claimsPrincipalSync.msalAccountId }}
        </p>
        <p><strong>Job Title:</strong> {{ claimsPrincipalSync.jobTitle }}</p>
        <p>
          <strong>Phone Number:</strong> {{ claimsPrincipalSync.phoneNumber }}
        </p>
        <p><strong>Office:</strong> {{ claimsPrincipalSync.office }}</p>
      </div>
      } @else {
      <p><code>null</code></p>
      }
    </div>
    <div class="result">
      <strong>Related CDAS wiki: </strong>

      <ul class="arrows-after">
        <li>
          <a
            [href]="externalLinks['cvxClaimsPrincipal'].url"
            target="_blank"
            rel="noopener noreferrer"
            >{{ externalLinks["cvxClaimsPrincipal"].text }}</a
          >
        </li>
      </ul>
    </div>
  </div>

  <div
    class="tab-content"
    role="tabpanel"
    [attr.aria-hidden]="activeTab !== 'claims-principal-async'"
    [style.display]="activeTab === 'claims-principal-async' ? 'block' : 'none'"
    data-content="claims-principal-async"
  >
    <div class="result">
      <button
        class="button small"
        (click)="fetchClaimsAsync()"
        [disabled]="loadingAsync"
      >
        Try getClaims()
      </button>
      <p><strong>‚öôÔ∏èMethod: </strong><code>getClaims()</code></p>
      <p><strong>üîÅReturn: </strong><code>ICvxClaimsPrincipal or null</code></p>
      <p><strong>üéØResult: </strong></p>
      @if (loadingAsync) {
      <p><strong>‚è≥Loading...</strong></p>
      } @else if (claimsPrincipalAsync) {
      <pre><code>{{ claimsPrincipalAsync | json }}</code></pre>
      } @else {
      <p><code>null</code></p>
      }
    </div>
    <div class="result">
      <strong>Related CDAS wiki: </strong>

      <ul class="arrows-after">
        <li>
          <a
            [href]="externalLinks['getClaims'].url"
            target="_blank"
            rel="noopener noreferrer"
            >{{ externalLinks["getClaims"].text }}</a
          >
        </li>
      </ul>
    </div>
  </div>
</div>
