<mat-toolbar color="primary" class="app-toolbar">
  <img src="assets/tco-logo.svg" alt="TCO logo" class="tco-logo" />
  <span class="toolbar-title">Bidding Platform</span>
  <span class="spacer"></span>
  <button
    type="button"
    class="error-indicator"
    *ngIf="hasErrors()"
    [matTooltip]="lastErrorMessage() || 'An unexpected error occurred.'"
    matTooltipPosition="below"
    [attr.aria-label]="errorAriaLabel()"
    (click)="clearErrors()"
  >
    <mat-icon aria-hidden="true">error_outline</mat-icon>
    <span class="error-count">{{ errorCount() }}</span>
  </button>
  <div class="auth-area" role="status" aria-live="polite">
    <ng-container *ngIf="authService.isLoading(); else authContent">
      <span class="auth-loading">Signing you in…</span>
    </ng-container>

    <ng-template #authContent>
      <ng-container *ngIf="authService.isSignedIn(); else authStatus">
        <span class="user-pill" title="Signed in as {{ authService.userName() }}">
          {{ authService.userName() || 'Signed in' }}
        </span>
      </ng-container>

      <ng-template #authStatus>
        <ng-container *ngIf="authService.error(); else signingIn">
          <span class="auth-error">
            <span class="auth-error-message">We couldn't sign you in.</span>
            <a routerLink="/sign-in-failed" class="auth-error-link">Get help</a>
          </span>
        </ng-container>

        <ng-template #signingIn>
          <span class="auth-loading">Preparing your workspace…</span>
        </ng-template>
      </ng-template>
    </ng-template>
  </div>
</mat-toolbar>
